<!DOCTYPE html>
<html>
<head>
    <title>Draw Audio File With d3</title>
<style>

.chart {
  padding: 3px;
  margin: 1px;
}

.axis--grid .domain {
  fill: #ddd;
  stroke: none;
}

.axis--x .domain,
.axis--grid .tick line {
  stroke: #fff;
}

.axis--grid .tick--minor line {
  stroke-opacity: .5;
}

</style>
</head>
<body>
    
<!-- https://bost.ocks.org/mike/bar/3/ -->

<svg class="chart"></svg>   

<!--<script src="libs/d3.v3.min.js"></script>-->
<script src="https://d3js.org/d3.v4.min.js"></script>

<script type="text/javascript">

const FIVE_MINUTES_IN_SECONDS = 180;

let data = [];
for( let i = 0; i < FIVE_MINUTES_IN_SECONDS; i ++) {
    data.push(i);
}

// settings
var margin = {top: 20, right: 30, bottom: 30, left: 40},
    widthScale = 1200,
    width = widthScale - margin.left - margin.right,
    height = 600 - margin.top - margin.bottom;
    marginBars = 15;


var x = d3.scaleTime()
    .domain([0, (data.length * 1000)]) // segundos a milisegundos...
    .range([0, width + margin.left + margin.right]);

// https://github.com/d3/d3-time-format

var xAxis = d3.axisBottom(x)
    .ticks(d3.timeSecond.every(5))
    .tickPadding([5])
    .tickFormat(d3.timeFormat('%M:%S'));

// get the element chart and set the settings
var chart = d3.select(".chart")
              .attr("width", widthScale + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
            .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top + ")");;

chart.append("g")
    .attr("class", "axis axis--grid")
    .attr("transform", "translate(0, " + height + ")")
    .call(d3.axisBottom(x)
        .ticks(d3.timeSecond.every(5))
        .tickSize(-height)
        .tickFormat(function() { return null; }))
    .selectAll(".tick")
        .classed("tick--minor", function(d) { return d.getHours(); });;
    
chart.append("g")
      .attr("class", "axis axis--x")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x)
            .ticks(d3.timeSecond.every(5))
            .tickPadding([5])
            .tickFormat(d3.timeFormat('%M:%S')));

chart.append("g")
    .attr("class", "brush")
    .call(d3.brushX()
        .extent([[0, 0], [width, height]])
        .on("brush", brushed));

function brushed() {
  if (d3.event.sourceEvent.type === "brush") return;
  var d0 = d3.event.selection.map(x.invert),
      d1 = d0.map(d3.timeMillisecond.round);

      console.log(d3.timeMillisecond.round);

  // If empty when rounded, use floor instead.
  if (d1[0] >= d1[1]) {
    d1[0] = d3.timeMillisecond.floor(d0[0]);
    d1[1] = d3.timeMillisecond.offset(d1[0]);
  }

  d3.select(this).call(d3.event.target.move, d1.map(x));
}

</script>
</body>
</html>